# Проектная работа "Веб-ларек"

Сообщение для проверяющего 8 спринта:
Я слтшком поздно заметил строку в задании, в которой говорится, что весь код в 8 спринте писать не нужно, поэтому похоже сделал немного наперед :D

*Интернет-магазин с товарами для веб-разработчиков — Web-ларёк. В нём можно посмотреть каталог товаров, добавить товары в корзину и сделать заказ.*

## Описание

В коде описаны классы, кажный из корторых выполняет свою определенную роль:

Model: отвечает за загрузку данных через API, их сохранение и обработку данных, полученных от пользователя.

Interface: отображает пользовательский интерфейс и отслеживает события, уведомляя о них.

Events(выполняет роль Presenter): он связывает модели данных с интерфейсами, управляя их взаимодействием при возникновении событий.

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Описание классов base

### 1. Класс API
Класс Api предназначен для взаимодействия с RESTful API, предоставляя удобный интерфейс для выполнения HTTP-запросов. Он инкапсулирует базовый URL и параметры запроса, что позволяет легко настраивать и использовать его в различных частях приложения.

Конструктор:
baseUrl: string — базовый URL, который будет использоваться для всех запросов.
options: RequestInit — объект с параметрами запроса, такими как заголовки. По умолчанию заголовок Content-Type установлен на application/json.

Методы класса:
handleResponse(response: Response): Promise<object> — защищенный метод, который обрабатывает ответ от сервера. Если ответ успешен, возвращает данные в формате JSON. В случае ошибки отклоняет промис с текстом ошибки.
get(uri: string): Promise<object> — выполняет GET-запрос по указанному URI. Возвращает промис, который разрешается в данные ответа.
post(uri: string, data: object, method: ApiPostMethods = 'POST'): Promise<object> — выполняет запросы с методами POST, PUT или DELETE по указанному URI с переданными данными. По умолчанию используется метод POST. Возвращает промис, который разрешается в данные ответа.

Типы:
ApiListResponse<Type> — тип, представляющий ответ списка от API, содержащий общее количество элементов и массив элементов указанного типа.
ApiPostMethods — тип, ограничивающий методы запросов для изменения данных (POST, PUT, DELETE).

### 2. Класс EventEmitter
Класс EventEmitter представляет собой реализацию брокера событий, который позволяет управлять подписками на события и их генерацией. Этот класс предоставляет механизм для регистрации обработчиков событий, их вызова и удаления.

Типы:
EventName: Псевдоним для строки или регулярного выражения, представляющего имя события.
Subscriber: Псевдоним для функции, которая будет вызвана при возникновении события.
EmitterEvent: Тип, представляющий событие с именем и данными.

Интерфейс IEvents:
Определяет методы on, emit и trigger, которые должны быть реализованы для работы с событиями.

Конструктор:
Инициализирует объект _events, который хранит карту событий и их подписчиков.

Методы класса:
on<T extends object>(eventName: EventName, callback: (event: T) => void): void — регистрирует обработчик для указанного события. Если событие еще не существует, создается новое множество подписчиков.
off(eventName: EventName, callback: Subscriber): void — удаляет обработчик для указанного события. Если после удаления подписчиков не остается, событие удаляется из карты.
emit<T extends object>(eventName: string, data?: T): void — инициирует событие, вызывая все зарегистрированные обработчики. Поддерживает подписку на все события ('*') и события по шаблону (регулярное выражение).
onAll(callback: (event: EmitterEvent) => void): void — регистрирует обработчик для всех событий.
offAll(): void — удаляет все обработчики для всех событий.
trigger<T extends object>(eventName: string, context?: Partial<T>): (data: T) => void — создает функцию-триггер, которая генерирует событие при вызове. Позволяет передавать контекст, который будет объединен с данными события.

## Описание классов interface

### 1. Класс BasketInterface
Класс BasketInterface представляет собой пользовательский интерфейс для корзины покупок в веб-приложении. Он реализует интерфейс IBasket и использует менеджер событий IEvents для управления взаимодействием с пользователем.

Конструктор:
template: HTMLTemplateElement — шаблон HTML, из которого создаются элементы интерфейса корзины.
eventManager: IEvents — менеджер событий, используемый для управления взаимодействием с пользователем.

Свойства класса:
basketElement: Основной элемент корзины, содержащий все остальные элементы.
titleElement: Элемент заголовка корзины.
productListElement: Элемент, содержащий список товаров в корзине.
checkoutButton: Кнопка для оформления заказа.
totalPriceElement: Элемент, отображающий общую стоимость товаров в корзине.
headerBasketButton: Кнопка корзины в заголовке страницы.
headerBasketCounter: Элемент, отображающий количество товаров в корзине в заголовке.

Методы класса:
set basketItems(items: HTMLElement[]): void — устанавливает элементы товаров в корзине. Если товаров нет, отображается сообщение "Корзина пуста", и кнопка оформления заказа отключается.
updateHeaderCartCounter(count: number): void — обновляет счетчик товаров в корзине в заголовке страницы.
updateTotalPrice(total: number): void — обновляет отображение общей стоимости товаров в корзине.
render(): HTMLElement — возвращает основной элемент корзины с заголовком "Корзина".

### 2. Класс BasketItemInterface
Класс BasketItemInterface представляет собой интерфейс для отображения элемента в корзине покупок. Он реализует интерфейс IBasketItem и использует шаблон HTML для создания структуры элемента, а также менеджер событий IEvents для управления взаимодействием с пользователем.

Конструктор:
template: HTMLTemplateElement — шаблон HTML, из которого создаются элементы интерфейса элемента корзины.
events: IEvents — менеджер событий, используемый для управления взаимодействием с пользователем.
actions?: IClickAction — необязательный параметр, который может содержать обработчик кликов для кнопки удаления.

Свойства класса:
basketItem: Основной элемент, представляющий товар в корзине.
basketItemIndex: Элемент, отображающий индекс товара в корзине.
basketItemTitle: Элемент, отображающий название товара.
basketItemPrice: Элемент, отображающий цену товара.
buttonDelete: Кнопка для удаления товара из корзины.

Методы класса:
setPrice(value: number | null): string — защищенный метод, который форматирует цену товара. Если цена равна null, возвращает строку "Бесценно".
render(data: IItem, item: number): HTMLElement — метод, который заполняет элемент данными о товаре и возвращает его. Устанавливает индекс, название и цену товара.

### 3. Класс CardInterface
Класс CardInterface представляет собой интерфейс для отображения карточки товара или элемента. Он реализует интерфейс ICard и использует шаблон HTML для создания структуры карточки, а также менеджер событий IEvents для управления взаимодействием с пользователем.

Конструктор:
template: HTMLTemplateElement — шаблон HTML, из которого создаются элементы интерфейса карточки.
events: IEvents — менеджер событий, используемый для управления взаимодействием с пользователем.
actions?: IClickAction — необязательный параметр, который может содержать обработчик кликов для всей карточки.

Свойства класса:
cardElement: Основной элемент, представляющий карточку.
categoryElement: Элемент, отображающий категорию карточки.
titleElement: Элемент, отображающий название карточки.
imageElement: Элемент изображения карточки.
priceElement: Элемент, отображающий цену карточки.
categoryColors: Объект, сопоставляющий категории с CSS-классами для стилизации.

Методы класса:
setElementText(element: HTMLElement, value: unknown): void — защищенный метод, который устанавливает текстовое содержимое элемента, если элемент существует.
set category(value: string): void — устанавливает категорию карточки, обновляя текст и класс элемента категории для стилизации.
formatPrice(value: number | null): string — защищенный метод, который форматирует цену. Если цена равна null, возвращает строку "Бесценно".
render(Data: IItem): HTMLElement — метод, который заполняет элементы карточки данными и возвращает её. Устанавливает категорию, название, изображение и цену.

### 4. Класс CardPreviewInterface
Класс CardPreviewInterface расширяет функциональность класса CardInterface, добавляя возможность предварительного просмотра карточки с дополнительной информацией и кнопкой для добавления в корзину. Он реализует интерфейс ICard и использует менеджер событий IEvents для управления взаимодействием с пользователем.

Конструктор:
template: HTMLTemplateElement — шаблон HTML, из которого создаются элементы интерфейса карточки.
events: IEvents — менеджер событий, используемый для управления взаимодействием с пользователем.
actions?: IClickAction — необязательный параметр, который может содержать обработчик кликов для всей карточки.

Свойства класса:
text: Элемент, отображающий описание карточки.
button: Кнопка для добавления карточки в корзину.

Методы класса:
checkAvailability(data: IItem): string — метод, который проверяет доступность товара. Если цена указана, возвращает текст "Купить". Если цена не указана, отключает кнопку и возвращает текст "Не продается".
render(data: IItem): HTMLElement — метод, который заполняет элементы карточки данными и возвращает её. Устанавливает категорию, название, изображение, цену, описание и текст кнопки.

### 5. Класс FormContactsInterface
Класс FormContactsInterface представляет собой интерфейс для формы обратной связи, реализующий интерфейс IFormContacts. Он использует шаблон HTML для создания структуры формы и менеджер событий IEvents для управления взаимодействием с пользователем.

Конструктор:
template: HTMLTemplateElement — шаблон HTML, из которого создаются элементы интерфейса формы.
events: IEvents — менеджер событий, используемый для управления взаимодействием с пользователем.

Свойства класса:
formContacts: Основной элемент формы.
inputAll: Массив всех элементов ввода в форме.
buttonSubmit: Кнопка отправки формы.
formErrors: Элемент для отображения ошибок формы.

Методы класса:
set valid(value: boolean): void — устанавливает состояние кнопки отправки формы. Если значение false, кнопка отключается.
render(): HTMLElement — возвращает основной элемент формы.

### 6. Класс FormInterface
Класс FormInterface представляет собой интерфейс для формы заказа, реализующий интерфейс IForm. Он использует шаблон HTML для создания структуры формы и менеджер событий IEvents для управления взаимодействием с пользователем.

Конструктор:
template: HTMLTemplateElement — шаблон HTML, из которого создаются элементы интерфейса формы.
events: IEvents — менеджер событий, используемый для управления взаимодействием с пользователем.

Свойства класса:
orderForm: Основной элемент формы.
paymentButtons: Массив кнопок, представляющих доступные методы оплаты.
submitButton: Кнопка отправки формы.
errorContainer: Элемент для отображения ошибок формы.

Методы класса:
set selectedPaymentMethod(paymentMethod: string): void — устанавливает выбранный метод оплаты, добавляя класс активного состояния к соответствующей кнопке.
set valid(value: boolean): void — устанавливает состояние кнопки отправки формы. Если значение false, кнопка отключается.
render(): HTMLElement — возвращает основной элемент формы.

### 7. Класс ModalInterface
Класс ModalInterface представляет собой интерфейс для модального окна, реализующий интерфейс IModal. Он управляет отображением и взаимодействием с модальным окном, используя менеджер событий IEvents для управления взаимодействием с пользователем.

Конструктор:
modalContainer: HTMLElement — контейнер модального окна, содержащий его структуру.
events: IEvents — менеджер событий, используемый для управления взаимодействием с пользователем.

Свойства класса:
modalElement: Основной элемент модального окна.
closeButton: Кнопка для закрытия модального окна.
modalContent: Элемент, содержащий контент модального окна.
pageWrapper: Элемент, который может быть заблокирован при открытии модального окна.

Методы класса:
set content(value: HTMLElement): void — устанавливает содержимое модального окна, заменяя текущие дочерние элементы.
open(): void — открывает модальное окно, добавляя класс активного состояния и инициируя событие modal:open.
close(): void — закрывает модальное окно, удаляя класс активного состояния, очищая содержимое и инициируя событие modal:close.
set isLocked(value: boolean): void — блокирует или разблокирует страницу, добавляя или удаляя класс блокировки у элемента pageWrapper.
render(): HTMLElement — открывает модальное окно и возвращает его основной элемент.

### 8. Класс SuccessInterface
Класс SuccessInterface представляет собой интерфейс для отображения сообщения об успешном выполнении операции, например, после успешного оформления заказа. Он использует шаблон HTML для создания структуры сообщения и менеджер событий IEvents для управления взаимодействием с пользователем.

Конструктор:
template: HTMLTemplateElement — шаблон HTML, из которого создаются элементы интерфейса сообщения.
events: IEvents — менеджер событий, используемый для управления взаимодействием с пользователем.

Свойства класса:
success: Основной элемент сообщения об успехе.
description: Элемент, отображающий описание или сообщение об успешной операции.
button: Кнопка для закрытия сообщения.

Методы класса:
render(total: number): HTMLElement — метод, который заполняет элемент сообщения данными и возвращает его. Устанавливает текст описания, указывая количество списанных синапсов.

## Описание классов models

### 1. Класс ApiModel
Класс ApiModel расширяет функциональность базового класса Api, предоставляя методы для взаимодействия с API, связанным с продуктами и заказами. Он реализует интерфейс IApi и использует базовый URL для API и URL для доставки контента.

Конструктор:
contentDeliveryUrl: string — базовый URL для доставки контента, такого как изображения.
apiBaseUrl: string — базовый URL для API.
options?: RequestInit — необязательные параметры запроса, которые могут быть переданы в конструктор базового класса Api.

Свойства класса:
contentDeliveryUrl: Хранит базовый URL для доставки контента.
productList: Список продуктов, полученных из API.

Методы класса:
fetchProductList(): Promise<IItem[]> — выполняет запрос к API для получения списка продуктов. Возвращает промис, который разрешается в массив продуктов. Каждый продукт дополняется URL изображения, используя contentDeliveryUrl.
submitOrder(order: IOrderBatch): Promise<IOrderConfirmation> — отправляет заказ на сервер. Возвращает промис, который разрешается в подтверждение заказа.

### 2. Класс BasketModel
Класс BasketModel реализует интерфейс IBasket и предоставляет функциональность для управления корзиной покупок. Он позволяет добавлять, удалять и очищать товары в корзине, а также получать общее количество товаров и их общую стоимость.

Свойства класса:
productsInCart: Массив, содержащий товары, добавленные в корзину.

Методы класса:
set productsInBasket(products: IItem[]): void — устанавливает список товаров в корзине.
get productsInBasket(): IItem[] — возвращает список товаров в корзине.
getProductCount(): number — возвращает количество товаров в корзине.
getTotalPrice(): number — возвращает общую стоимость всех товаров в корзине. Использует метод reduce для суммирования цен всех товаров.
addProductToBasket(product: IItem): void — добавляет товар в корзину.
removeProductFromBasket(product: IItem): void — удаляет товар из корзины, если он присутствует.
clearBasket(): void — очищает корзину, удаляя все товары

### 3. Класс DataModel
Класс DataModel реализует интерфейс IData и предоставляет функциональность для управления списком продуктов и предварительным просмотром выбранного продукта. Он использует менеджер событий IEvents для управления взаимодействием с пользователем.

Конструктор:
eventManager: IEvents — менеджер событий, используемый для управления взаимодействием с пользователем.

Свойства класса:
products: Массив, содержащий список продуктов.
selectedProduct: Выбранный продукт для предварительного просмотра.

Методы класса:
set productList(products: IItem[]): void — устанавливает список продуктов и инициирует событие products:updated, уведомляя о том, что список продуктов был обновлен.
get productList(): IItem[] — возвращает текущий список продуктов.
previewProduct(product: IItem): void — устанавливает выбранный продукт и инициирует событие modalCard:open, передавая выбранный продукт для предварительного просмотра.

### 4. Класс FormModel
Класс FormModel реализует интерфейс IFormModel и предоставляет функциональность для управления данными формы заказа, включая валидацию адреса и контактной информации. Он использует менеджер событий IEvents для управления взаимодействием с пользователем.

Конструктор:
events: IEvents — менеджер событий, используемый для управления взаимодействием с пользователем.

Свойства класса:
paymentMethod: Способ оплаты.
email: Электронная почта.
phone: Номер телефона.
address: Адрес доставки.
total: Общая стоимость заказа.
items: Список товаров в заказе.
formErrors: Объект для хранения ошибок валидации формы.

Методы класса:
setAddress(field: string, value: string): void — устанавливает адрес доставки. Если адрес проходит валидацию, инициирует событие order:ready, передавая данные заказа.
validateAddress(): boolean — валидирует адрес доставки. Проверяет, что адрес не пустой, соответствует регулярному выражению и выбран способ оплаты. Возвращает true, если ошибок нет.
setContactInfo(field: string, value: string): void — устанавливает контактную информацию (email или телефон). Если данные проходят валидацию, инициирует событие order:ready, передавая данные заказа.
validateContactInfo(): boolean — валидирует контактную информацию. Проверяет, что email и телефон не пустые и соответствуют регулярным выражениям. Возвращает true, если ошибок нет.
getOrderData(): object — возвращает объект с данными заказа, включая способ оплаты, контактную информацию, адрес, общую стоимость и список товаров.

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
